# name: test/sql/metastore_scan.test
# description: test metastore_scan table function
# group: [sql]

# Require metastore extension to be loaded
require metastore

# Test 1: metastore_scan with valid arguments but no ATTACH produces catalog-not-found error
statement error
SELECT * FROM metastore_scan('test_catalog', 'test_schema', 'test_table')
----
not attached as metastore

# Test 2: Catalog not found error (not an arg error) proves the function exists
statement error
SELECT COUNT(*) FROM (
  SELECT * FROM metastore_scan('catalog1', 'schema1', 'table1')
)
----
not attached as metastore

# Test 3: metastore_scan with missing required arguments should fail
statement error
SELECT * FROM metastore_scan('test_catalog', 'test_schema')
----

# Test 4: metastore_scan with NULL arguments should fail
statement error
SELECT * FROM metastore_scan(NULL, 'schema', 'table')
----

# Test 5: metastore_scan with empty string arguments should fail
statement error
SELECT * FROM metastore_scan('', 'schema', 'table')
----
