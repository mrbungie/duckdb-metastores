# name: test/sql/metastore/generic/extension_load.test
# description: verify the metastore extension loads and metastore_scan function exists
# group: [sql]

# Before the extension is loaded, metastore_scan must not exist
statement error
SELECT * FROM metastore_scan('catalog', 'schema', 'table');
----
Catalog Error

# Require statement ensures this test runs with the metastore extension loaded
require metastore

# After loading, a valid call to metastore_scan errors with catalog-not-found (not function-not-found)
statement error
SELECT * FROM metastore_scan('my_catalog', 'my_schema', 'my_table');
----
not attached as metastore

# Verify metastore_scan schema: a catalog-not-found error (not an arg error) proves the function loaded
statement error
SELECT * FROM metastore_scan('my_catalog', 'my_schema', 'my_table');
----
not attached as metastore
