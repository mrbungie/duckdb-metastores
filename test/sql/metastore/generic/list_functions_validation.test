# name: test/sql/metastore/generic/list_functions_validation.test
# description: validate metastore_list_namespaces and metastore_list_tables argument constraints
# group: [sql]

require metastore

# ---- metastore_list_namespaces: missing argument ----

statement error
SELECT * FROM metastore_list_namespaces();
----
metastore_list_namespaces requires 1 argument

# ---- metastore_list_namespaces: NULL argument ----

statement error
SELECT * FROM metastore_list_namespaces(NULL);
----
cannot be NULL

# ---- metastore_list_namespaces: empty string argument ----

statement error
SELECT * FROM metastore_list_namespaces('');
----
cannot be empty

# ---- metastore_list_namespaces: unregistered catalog produces catalog-not-found error ----

statement error
SELECT * FROM metastore_list_namespaces('nonexistent_catalog');
----
not attached as metastore

# ---- metastore_list_tables: missing arguments ----

statement error
SELECT * FROM metastore_list_tables('catalog_only');
----
metastore_list_tables requires 2 arguments

statement error
SELECT * FROM metastore_list_tables();
----
metastore_list_tables requires 2 arguments

# ---- metastore_list_tables: NULL arguments ----

statement error
SELECT * FROM metastore_list_tables(NULL, 'ns');
----
(catalog) cannot be NULL

statement error
SELECT * FROM metastore_list_tables('catalog', NULL);
----
(namespace) cannot be NULL

# ---- metastore_list_tables: empty string arguments ----

statement error
SELECT * FROM metastore_list_tables('', 'ns');
----
(catalog) cannot be empty

statement error
SELECT * FROM metastore_list_tables('catalog', '');
----
(namespace) cannot be empty

# ---- metastore_list_tables: unregistered catalog produces catalog-not-found error ----

statement error
SELECT * FROM metastore_list_tables('nonexistent_catalog', 'default');
----
not attached as metastore
