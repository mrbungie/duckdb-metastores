# name: test/sql/metastore/integration/hms_duckdb_smoke.test
# description: validate DuckDB queries and HMS metastore_scan on local container
# group: [sql]

require metastore

statement ok
CREATE TEMP TABLE duckdb_smoke(i INTEGER);

statement ok
INSERT INTO duckdb_smoke VALUES (7), (11);

query I
SELECT SUM(i) FROM duckdb_smoke;
----
18

statement ok
ATTACH 'thrift://127.0.0.1:9083' AS hms (TYPE metastore);

statement error
SELECT * FROM metastore_scan('hms', 'default', 'missing_table');
----
HMS table not found
