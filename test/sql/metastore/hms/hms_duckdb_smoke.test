# name: test/sql/metastore/integration/hms_duckdb_smoke.test
# description: validate DuckDB queries and HMS metastore_scan on local container
# group: [sql]

require metastore

require-env HMS_LOCAL_ENDPOINT

test-env HMS_LOCAL_ENDPOINT 127.0.0.1:9083


statement ok
CREATE TEMP TABLE duckdb_smoke(i INTEGER);

statement ok
INSERT INTO duckdb_smoke VALUES (7), (11);

query I
SELECT SUM(i) FROM duckdb_smoke;
----
18

statement ok
ATTACH 'thrift://${HMS_LOCAL_ENDPOINT}' AS hms (TYPE metastore);

statement error
SELECT * FROM metastore_scan('hms', 'default', 'missing_table');
----
HMS table not found

# The actual partition pruning tests will be run by the generated script
# but we can verify EXPLAIN string parsing works if we implement to_string
